<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
    <script type="text/javascript" src="https://miro.com/app/static/sdk.1.1.js"></script>
</head>

<style>
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    #container {
        height: 100%;
        overflow-y: auto;
        overflow-x: hidden;
        display: flex;
        flex-wrap: wrap;
        flex-direction: row;
        align-items: center;
        padding-top: 32px;
        box-sizing: border-box;
    }

    .row {
        display: flex;
        flex-direction: row;
        padding-left: 32px;
        margin-bottom: 32px;
    }

    .draggable-item {
        margin-left: 32px;
        margin-bottom: 32px;
        width: 112px;
        height: 112px;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #fff;
        font-size: 18px;
        font-family: sans-serif;
    }

    .draggable-item.red {
        background-color: #f24726;
    }

    .draggable-item.green {
        background-color: #0ca788;
    }

    .image-box img {
        max-width: 112px;
        max-height: 112px;
        cursor: pointer;
    }

</style>
<body>
<div id="container">
</div>
<script>

	const images = [
		{src: 'img/SLIDE1.SVG', width: 267.02, height: 218.31},
		{src: 'img/SLIDE2.SVG', width: 267.02, height: 218.31},
		{src: 'img/SLIDE3.SVG', width: 267.02, height: 218.31},
		{src: 'img/SLIDE4.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE5.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE6.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE7.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE8.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE9.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE10.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE11.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE12.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE13.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE14.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE15.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE16.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE17.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE18.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE19.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE20.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE21.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE22.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE23.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE24.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE25.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE26.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE27.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE28.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE29.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE30.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE31.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE32.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE33.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE34.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE35.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE36.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE37.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE38.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE39.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE40.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE41.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE42.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE43.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE44.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE45.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE46.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE47.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE48.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE49.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE50.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE51.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE52.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE53.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE54.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE55.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE56.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE57.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE58.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE59.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE60.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE61.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE62.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE63.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE64.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE65.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE66.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE67.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE68.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE69.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE70.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE71.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE72.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE73.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE74.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE75.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE76.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE77.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE78.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE79.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE80.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE81.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE82.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE83.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE84.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE85.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE86.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE87.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE88.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE89.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE90.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE91.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE92.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE93.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE94.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE95.SVG', width: 267.02, height: 218.31},
{src: 'img/SLIDE96.SVG', width: 267.02, height: 218.31},

	
	]

	function getImage(img) {
		return `<div class="draggable-item image-box">
		        <img src="${img.src}" data-image-url="https://montcassel.github.io/app-examples/drag-and-drop/${img.src}">
		        </div>`
	}

	function addShapes(container) {
		container.innerHTML += '<div class="shape draggable-item green" data-color="0ca788">I am shape</div>' +
			'<div class="shape draggable-item red" data-color="f24726">Me too</div>'
	}

	function addImages(container) {
		container.innerHTML += images.map(i => getImage(i)).join('')
	}

	function createImage(canvasX, canvasY, url) {
		console.log(url)
		return miro.board.widgets.create({
			type: 'image',
			url: url,
			x: canvasX,
			y: canvasY,
		})
	}

	function createShape(canvasX, canvasY, color, text) {
		return miro.board.widgets.create({
			type: 'shape',
			text: text,
			x: canvasX,
			y: canvasY,
			style: {
				textColor: '#fff',
				backgroundColor: '#' + color,
				borderColor: 'transparent'
			}
		})
	}

	function bootstrap() {
		const container = document.getElementById('container')
		addShapes(container)
		addImages(container)

        let currentImageUrl
		const imageOptions = {
			draggableItemSelector: 'img',
			onClick: async (targetElement) => {
				const url = targetElement.getAttribute('data-image-url')
				const widget = (await createImage(0, 0, url))[0]
				miro.board.viewport.zoomToObject(widget)

			},
			getDraggableItemPreview: (targetElement) => { //drag-started
				currentImageUrl = targetElement.getAttribute('data-image-url')
				return {
					width: 100,
					height: 100,
					url: currentImageUrl
				}
			},
			onDrop: (canvasX, canvasY) => {
				console.log('onDrop 1')
				createImage(canvasX, canvasY, currentImageUrl)
			}
		}
		miro.board.ui.initDraggableItemsContainer(container, imageOptions)

		let currentShapeColor
		let currentShapeText
		const shapeOptions = {
			draggableItemSelector: '.shape',
			onClick: async (targetElement) => {
				const color = targetElement.getAttribute('data-color')
				const text = targetElement.innerText
				const widget = (await createShape(0, 0, color, text))[0]
				miro.board.viewport.zoomToObject(widget)

			},
			getDraggableItemPreview: (targetElement) => {
				currentShapeColor = targetElement.getAttribute('data-color')
				currentShapeText = targetElement.innerText
				return {
					url: `data:image/svg+xml,%3Csvg width='140' height='140' xmlns='http://www.w3.org/2000/svg'%3E%3Cg%3E%3Crect stroke='null' x='0' y='0' fill='%23${currentShapeColor}' height='140' width='140'/%3E%3C/g%3E%3C/svg%3E`
				}
			},
			onDrop: (canvasX, canvasY) => {
				console.log('onDrop 2')
				createShape(canvasX, canvasY, currentShapeColor, currentShapeText)
			}
		}
		miro.board.ui.initDraggableItemsContainer(container, shapeOptions)
	}

	miro.onReady(bootstrap)
</script>
</body>
</html>
